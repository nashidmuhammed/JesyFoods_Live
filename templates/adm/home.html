<!DOCTYPE html>
{% extends 'base.html' %}
{% load static %}
{% load mathfilters %}
<html lang="en">
<head>
    {% block content %}
<link rel="stylesheet" href="{% static 'css/adm_style.css' %}">
<title>HOME | JesyFoods</title>
</head>
<body>

{% include "adm/base_side_nav.html" %}

    <section class="home_content">
        <div class="black"><i class="fa fa-times" aria-hidden="true"></i></div>
        <div class="nav_top" {% if is_sunday %}style="background-color:#bb0000" {% endif %}>
            <div class="hed">
            <!-- <i class="fa fa-bars" id="btn_bar-2" aria-hidden="true"></i> -->
            <a   class="back-btn" id="btn_bar-2" ><i class="fa fa-bars" aria-hidden="true"></i></a>
                Jesy Foods
            </div>           
        <ul class="nav justify-content-end">
            <li class="nav-item">
              <a class="nav-link" href="admin_panel"> <i class="fa fa-th-large" aria-hidden="true"></i></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="view_messages"><i class="fa fa-bell"></i><span class="badge badge-pill badge-danger">{%if count_msg != 0 %}{{count_msg}}{%endif%}</span></a>
            </li>
            
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"><i class="fa fa-user"></i>
                    <span class="name">{{request.user}}</span>
               </a>
                <div class="dropdown-menu">
                    <a class="dropdown-item" href="MyAccount"><i class="fa fa-user-circle-o"></i> My Account</a>
                      <a class="dropdown-item" href="price_list"><i class="fa fa-money" aria-hidden="true"></i> Price List</a>
                      <a class="dropdown-item" href="settings"><i class="fa fa-cog" aria-hidden="true"></i>&nbsp; Settings</a>
                      <div class="dropdown-divider"></div>
                      <a class="dropdown-item logout" style="color: red;" href="{% url 'logout' %}"><i class="fa fa-sign-out" aria-hidden="true"></i> Logout</a>
                      </div>
              </li>
          </ul>
    </div>
<br>

<section id="home" class="Home_content">
  <div class="container ">
    <div class="wrapper">
        {% if sett.home_order == True %}
        <div class="col">
            <a href="view_orders">
            <div class="ibox">
                <i class="fa fa-clock-o" aria-hidden="true" style="color: rgba(134, 112, 12, 0.667);"> Pending Orders</i> 
                <h4>{{data.count}}</h4>
            </div>
            </a>
        </div>
        {% endif %}
        {% if sett.home_daybook == True %}
        <div class="col">
            <a href="daybook">
            <div class="ibox">
                <i class="fa fa-line-chart" aria-hidden="true"> Today</i> 
                <h4>&#8377; {{data.tot_sale|floatformat:0}}</h4>
                <p>Collection:&#8377; {{data.total|floatformat:0}}</p>
            </div>
            </a>
        </div>
        {% endif %}
        {% if sett.home_sale == True %}
        <div class="col">
            <a href="sale_report">
            <div class="ibox">
                <i class="fa fa-line-chart" aria-hidden="true"> Sales({{data.sale_increment}}%)</i> 
                <h4>&#8377; {{data.month_tot|floatformat:0}}</h4>
                <p>Prev:&#8377; {{data.prev_tot|floatformat:0}}</p>
                <span>{{data.this_month|date:'M-d'}} <strong>-</strong> {{data.month_end|date:'M-d'}}</span><br>
                      &nbsp;
                 </div>
        </a>
        </div>
        {% endif %}
        {% if sett.home_credit == True %}
        <div class="col">
            <a href="{% url 'home' %}?credit=1">
            <div class="ibox">
                <i class="fa fa-arrow-down" aria-hidden="true" style="color: green;"> Credit</i> 
                <h4>&#8377; {{data.cr|floatformat:0}}</h4>
                <span>All Party</span>
            </div>
            </a>
        </div>
        {% endif %}
        {% if sett.home_expense == True %}
        <div class="col" >
                  <a href="view_expense">
                  <div class="ibox">
                      <i class="fa fa-money" aria-hidden="true" style="color: #d9632d;"> Expenses</i>
                      <h4>&#8377; {{data.expense|floatformat:0}}</h4>
                      <!-- <p>Prev:&#8377; 48,685</p> -->
                      <span>{{data.this_month|date:'M-d'}}  <strong>-</strong>  {{data.month_end|date:'M-d'}}</span>
                  </div>
              </a>
              </div>
        {% endif %}
    </div>


  </div>
</section>

<section class="container pb-5">
    <div class="party search">
        <form id="form1" action="{% url 'home' %}" method="post">{% csrf_token %}
        <div class="input-group mb-3">
            <div class="input-group-prepend">
                <select name="route" class="custom-select" id="day_filter">
                    <option selected>{{data.route}}</option>
                    <option value="All">All</option>
                    <option value="Mon">Mon</option>
                    <option value="Tue">Tue</option>
                    <option value="Wed">Wed</option>
                    <option value="Thu">Thu</option>
                    <option value="Fri">Fri</option>
                    <option value="Sat">Sat</option>
                </select>
            </div>
            <input id="search" autocomplete="off" name="search" type="search" class="form-control search" placeholder="Search..." value="{% if data.sr != None %}{{data.sr}}{% endif %}">
               <div class="input-group-append">
                <button type="submit" class="btn btn-outline-success"><i class="fa fa-search" aria-hidden="true"></i>                </button>
            </div>
        </div>
        </form>
    </div>
    {% for message in messages %}
    <div class="alert alert-success">
        {{message}}
    </div>
    {% endfor %}
    <div id="alert" class="alert alert-info" style="display: none;">
        <p id="msg"></p>
    </div>
    <table class="table table-hover ">
        <tbody>
            {% if party_pg %}
            {% for i in party_pg.object_list %}
              <tr onclick="document.location='{% url 'party_view' %}?data={{i.id}}';">
                <td>
                   {{i.party_name}}
                 <br> <span class="sm-p sm-p-n" >{{i.updated|date}}</span>
                </td>
                <td><p class="bal-p">&#8377; {{i.balance}}</p></td>
              </tr>
            {% endfor %}
            {% else %}
            <td>No data to found!</td>
            {% endif %}


            </tbody>
      </table>
      <nav aria-label="Page navigation example">
        <ul class="pagination justify-content-center">
          {%if party_pg.has_previous %}
          <li class="page-item">
            <a class="page-link" href="?page={{party_pg.previous_page_number}}" aria-label="Previous">
              <span aria-hidden="true">&laquo;</span>
              <span class="sr-only">Previous</span>
            </a>
          </li>
      
          <!-- <li class="page-item"><a class="page-link" href="?page={{party_pg.number|sub:3}}">{{party_pg.number|sub:3}}</a></li>
          <li class="page-item"><a class="page-link" href="?page={{party_pg.number|sub:2}}">{{party_pg.number|sub:2}}</a></li> -->
          <li class="page-item"><a class="page-link" href="?page={{party_pg.number|sub:1}}">{{party_pg.number|sub:1}}</a></li>
      
          {% endif %}
          <li class="page-item"><a class="page-link" href="?page={{party_pg.number}}" style="color: #000;">{{party_pg.number}}</a></li>
          {%if party_pg.has_next %}
          <li class="page-item"><a class="page-link" href="?page={{party_pg.number|add:1}}">{{party_pg.number|add:1}}</a></li>
          <li class="page-item"><a class="page-link" href="?page={{party_pg.number|add:2}}">{{party_pg.number|add:2}}</a></li>
          <li class="page-item"><a class="page-link" href="?page={{party_pg.number|add:3}}">{{party_pg.number|add:3}}</a></li>    
          <li class="page-item">
            <a class="page-link" href="?page={{party_pg.next_page_number}}" aria-label="Next">
              <span aria-hidden="true">&raquo;</span>
              <span class="sr-only">Next</span>
            </a>
          </li>
          {% endif %}
        </ul>
      </nav>



</section>




<br>


<section class="bott_but">

    <div class="container fixed-bottom">
        <div class="info_box">
            <a type="button" class="btn btn-success" href="{% url 'take_payment' %}">
                <p>Add Receipt</p>
            </a>
            <a class="btn btn-secondary btn-sm"  data-toggle="modal" data-target="#AddMore">
                <p>+</p>
            </a>
            <a type="button" class="btn btn-primary" href="{% url 'add_sale' %}">
                <p>Add Sale</p>
            </a>
  
        </div>
    </div>
    
</section>
</section>
<!-- Modal -->
     <div class="modal fade" id="AddMore"  role="dialog" aria-labelledby="AddMoreTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
          <div class="modal-header">
          <h5 class="modal-title" id="AddMoreLongTitle">Add More</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
          </div>
          <div class="modal-body btn_grp">
            <a href="add_party" type="button" class="btn btn-outline-primary">Add New Party</a>
            <button  type="button" class="btn btn-outline-dark" data-dismiss="modal" data-toggle="modal" data-target="#AddReport">Add Report / Feedback</button>
             <a href="add_order" type="button" class="btn btn-outline-info">Add Order</a>
            <a href="take_payment" type="button" class="btn btn-outline-success">Add Receipt</a>
            <button type="button" class="btn btn-outline-warning"  data-dismiss="modal" data-toggle="modal" data-target="#AddExpence">Add Expenses</button>
            <button  type="button" class="btn btn-outline-danger" data-dismiss="modal" data-toggle="modal" data-target="#takeCollection">Take Collection</button>
            <a href="add_purchase" type="button" class="btn btn-outline-secondary">Add Purchase</a>
            
            <!-- <button type="button" class="btn btn-outline-dark">Add Sale</button> -->

          </div>
          <div class="modal-footer">

          </div>
      </div>
      </div>
    </div>
     <!-- Add Expence Modal -->
     <div class="modal fade" id="AddExpence" role="dialog" aria-labelledby="AddExpenceTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
            <h5 class="modal-title" id="AddExpenceLongTitle">Add Expence</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            </div>
            <div class="modal-body">
                <select id="exp" class="form-control">
                    <option>Petrol</option>
                    <option>Food</option>
                    <option>Hospital</option>
                    <option>Other</option>
                </select>
                <div class="input-group mt-3">
                    <div class="input-group-prepend">
                      <span class="input-group-text" id="basic-addon1">Amount &#8377;</span>
                    </div>
                    <input id="amount" type="number" class="form-control" placeholder="000.00" >
                  </div>
                <div class="form-group mt-3">
                  <textarea id="disc_expence" class="form-control" rows="3" placeholder="Description (optional)"></textarea>
                </div>

            </div>
            <div class="modal-footer">
              <button id="sub_exp" class="btn btn-warning btn-block">Submit</button>
            </div>
        </div>
        </div>
      </div>

    <!-- Add Report Modal -->
     <div class="modal fade" id="AddReport" role="dialog" aria-labelledby="AddReportTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
          <div class="modal-header">
          <h5 class="modal-title" id="AddReportLongTitle">Add Report / Feedback</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
          </div>
          <div class="modal-body">
            <div class="form-check form-check-inline mb-2">
                <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio1" value="Report" checked>
                <label class="form-check-label" for="inlineRadio1">Report</label>
              </div>
              <div class="form-check form-check-inline mb-2">
                <input class="form-check-input" type="radio" name="inlineRadioOptions" id="inlineRadio2" value="Feedback" >
                <label class="form-check-label" for="inlineRadio2">Feedback</label>
              </div>
                <select name="s_party" class="form-control" id="s_party"  style="width:100%;">
              <option selected>{{party_ob.party_name}}</option>
                {% if party %}
                {% for i in party %}
              <option value="{{i.party_name}}">{{i.party_name}}</option>
              {% endfor %}
              {% endif %}
            </select>
              <select id="rsn" class="form-control form-control-sm mt-3">
                  <option>-----</option>
                  <option>Stock</option>
                  <option>Closed and unreachable call</option>
                  <option>No owner and unreachable call</option>
                  <option>Other</option>
              </select>
              <div class="form-group mt-3">
                <textarea id="disc" class="form-control" rows="3" placeholder="Description"></textarea>
              </div>

          </div>
          <div class="modal-footer">
            <button id="sub_repor" class="btn btn-info btn-block">Submit</button>
          </div>
      </div>
      </div>
    </div>
 
    
    <!-- ALert Modal -->
    {% if notn %}
    {% for i in notn %}
<div class="modal fade" id="notn" tabindex="-1" role="dialog" aria-labelledby="notnTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="notnTitle">{{i.heading}}</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <input type="text" id="Nid" value="{{i.id}}" hidden>

       <p> {{ i.body|linebreaks|urlize }} </p>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Later</button>
        <button id="delNot" type="button" class="btn btn-success" data-dismiss="modal">Okey</button>
        <!-- <button type="button" class="btn btn-success">OK</button> -->
      </div>
    </div>
  </div>
</div>
{% endfor %} 
{% endif %}

    <!-- Modal collect collection-->
<div class="modal fade" id="takeCollection"  role="dialog" aria-labelledby="takeCollectionTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="takeCollectionTitle">Take Collection</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
            <select name="s_party" class="form-control" id="cs_party" style="width: 100%;">
                <option selected>--Select a staff---</option>
                  {% if profile %}
                  {% for i in profile %}
                <option value="{{i.user}}">{{i.user}}</option>
                {% endfor %}
                {% endif %}
              </select>

                <div class="input-group mt-3">
                    <div class="input-group-prepend">
                      <span class="input-group-text" id="basic-addn1">Amount &#8377;</span>
                    </div>
                    <input id="c_amount" type="number" class="form-control" placeholder="000.00" >
                  </div>
                <div class="input-group mt-3">
                  <div class="input-group-prepend">
                    <label class="input-group-text" for="p_type">Payment Type</label>
                  </div>
                  <select  class="custom-select" id="p_type">
                    <option selected>Cash</option>
                    <option>Bank</option>
                    <option>GPay</option>
                    <option>Cheque</option>
                    <option>Other</option>
                  </select>
                </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button id="sub" type="button" class="btn btn-primary">Submit</button>
        </div>
      </div>
    </div>
  </div>

   
<script src="{% static 'js/home.js' %}"></script>
<script src="{% static 'js/adm.js' %}"></script>
<script>
  {% if notn %}
   $(window).on('load', function() {
      $('#notn').modal('show');
  });
  {% endif %}
    $('#home').addClass('active');
 </script>
<!--<script src="{% static 'js/add_order.js' %}"></script>-->
{% endblock %}

</body>
</html>